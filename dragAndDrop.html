<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0 minimum-scale=1.0 maximum-scale=1.0">
    <meta name="robots" content="noindex,nofollow">
    <meta name="googlebot" content="noindex,nofollow">
    <title>Drag and drop</title>
    <style>
        body{
            margin: 1rem;
        }
        .root-drag .main{
            display: flex;
        }
        .root-drag .item{
            flex:  auto;
            height: 100px;
            margin: 0 0.5rem;
            border:  1px solid rgba(0, 0, 128, 0.1);
            background: rgba(0, 0, 128, 0.1);

            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>

<h1>Drag and Drop</h1>

<section class="root-drag">
    <h2>Drag</h2>
    <div class="main">
        <div class="item" draggable="true" id="draggable">Draggable</div>
        <div class="item" id="toDrag">To drag</div>
    </div>
</section>


<script>

    const draggableEl = document.querySelector('#draggable');

    draggableEl.addEventListener('dragstart', () => {
        console.log('dragstart event');
    });

    // drag 이벤트는 드래그 중인 상태라면 지속적으로 발생하는 이벤트이므로 주의가 필요하다.
    draggableEl.addEventListener('drag', () => {
        console.log('drag event');
    });

    draggableEl.addEventListener('dragend', () => {
        console.log('dragend event');
    });



    const toDragEl = document.querySelector('#toDrag');

    toDragEl.addEventListener('dragenter', () => {
        console.log('dragenter event');
    });

    /*
    1. dragover 이벤트는 포인터가 요소에 위치해 있으면 이벤트가 지속적으로 발생한다.
    2. dragover 이벤트 무효화
        드롭 파일의 처리는 drop 이벤트를 사용한다.
        브라우저에 파일을 드래그 앤 드롭하면 페이지의 이동이 발생하므로 dragover 이벤트의 event.preventDefault() 처리가 필수다.
    */
    toDragEl.addEventListener('dragover', (event) => {
        event.preventDefault();
        console.log('dragover event');
    });

    toDragEl.addEventListener('dragleave', () => {
        console.log('dragleave evnet');
    });


</script>



<style>
    .root-drop{
        margin-top: 2rem;
    }
    .root-drop .main{
    }
    .root-drop .item{
        min-height: 100px;
        margin-top: 1rem;
        padding: 10px 0;
        border: 1px solid rgba(0, 128, 0, 0.1);
        background: rgba(0, 128, 0, 0.1);

        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }
    .root-drop .item p {
        margin: 0;
    }

</style>
<section class="root-drop">
    <h2>Drop</h2>
    <div class="main">
        <div class="item" id="drop">파일을 여기에 놓아주세요.</div>
        <div class="item" id="files">업로드한 이미지</div>
    </div>
</section>

<script>
    const dropEl = document.querySelector('#drop');
    const filesEl = document.querySelector('#files');

    // 드롭 요소가 중복된 경우 처리
    dropEl.addEventListener('dragover', (event) => {
        // 기본 이벤트 작동 해지
        event.preventDefault();
    });

    // 드롭 처리
    dropEl.addEventListener('drop', (event) => {
        // 기본 이벤트 작동 해지
        event.preventDefault();

        // File 객체 참조
        const transferedFiles = event.dataTransfer.files;

        // 이미지 표시
        displayImages(transferedFiles);

    });

    // 이미지 표시 처리
    function displayImages(transferedFiles){
        const arr = [];
        for(let file of transferedFiles){
            arr.push(`<p>${file.name}</p>`)
        }
        filesEl.innerHTML = arr.join('');
    }
</script>


</body>
</html>